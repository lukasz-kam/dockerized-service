# dockerized-service

The code in the repo is used to create an AWS EC2 instance,
create docker image for the nodejs app and deploy it to the server.
It also includes github actions workflow for building new docker image
for the ```node-app``` and deploying it to the EC2 instance whenever files
in the folder are changed.


### 1. Create EC2 instance with terraform
  ```
  cd terraform
  terraform init
  terraform apply
  ```
### 2. Deploy app to the server
  ```
  Github actions deploy app to a server either manually by
  triggering a workflow, or automatically when files in the node-app folder change.
  ```

### Addidional info

  - You need to have AWS credentials in ~/.aws/credentials for terraform to work.
  - Your AWS role should have all the necessary permissions to create EC2 instances.
  - Instead of using an .env file I put all the secrets in the github repo secrets:

    1. AUTH_PASSWORD, AUTH_USERNAME, SECRET_MESSAGE
    and SESSION_SECRET - secrets needed for the node app to work
    2. DOCKERHUB_IMAGE - ```<username>/<repo_name>:<tag>``` - image name and tag for dockerhub
    to upload the generated docker image
    3. DOCKER_PASSWORD and DOCKER_USERNAME - dockerhub credentials
    4. EC2_USER - ssh username for connecting to the server
    5. SERVER_IP - ip of the server
    6. SSH_EC2_KEY - key generated by terraform for ssh connection

Link to the project details: [https://roadmap.sh/projects/dockerized-service-deployment](https://roadmap.sh/projects/dockerized-service-deployment).